{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Usuario\\\\reactProjects\\\\findYourHouse\\\\app\\\\src\\\\components\\\\SignUpPage.js\";\nimport React, { useEffect, useState, useRef } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { withRouter, Link } from 'react-router-dom';\nimport * as houseActions from '../actions/houseActions';\nimport signup from '../styles/SignUpPage.module.css';\nimport Alert from './Alert';\nimport Loader from './Loader';\n\nconst SignUpPage = ({\n  history,\n  type,\n  actions,\n  state\n}) => {\n  const [alert, setAlert] = useState(false);\n  const form = useRef(null);\n  useEffect(() => {\n    if (state.authenticated && (!localStorage.getItem('token') || localStorage.getItem('token') === 'undefined')) {\n      history.push('/list', state);\n      localStorage.setItem('token', state.authenticated);\n      localStorage.setItem('id', state.currentUser.id);\n    } else if (localStorage.getItem('token') && !state.authenticated) {\n      const token = localStorage.getItem('token');\n      const currentU = localStorage.getItem('id');\n      actions.fetchSubscription(`https://aqueous-wildwood-18424.herokuapp.com/users/${currentU}`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      }, null, true);\n    } else if (state.authenticated) {\n      history.push('/list', state);\n    }\n  }, [state.authenticated]);\n\n  const handleSubmit = async formContent => {\n    if (type === 'IN') {\n      actions.fetchSubscription('https://aqueous-wildwood-18424.herokuapp.com/auth/login', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: `${formContent.email}`,\n          password: `${formContent.password}`\n        }),\n        headers: {\n          'Content-Length': 57,\n          'Content-Type': 'application/json; charset=utf-8'\n        },\n        credentials: 'same-origin'\n      }, 'SIGNIN');\n    } else if (type === 'UP') {\n      actions.fetchSubscription('https://aqueous-wildwood-18424.herokuapp.com/auth/signup', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: `${formContent.email}`,\n          password: `${formContent.password}`,\n          password_confirmation: `${formContent.passwordConfirmation}`,\n          name: `${formContent.name}`,\n          picture: 'https://joeschmoe.io/api/v1/random'\n        }),\n        headers: {\n          'Content-Length': 57,\n          'Content-Type': 'application/json; charset=utf-8'\n        },\n        credentials: 'same-origin'\n      }, 'SIGNIN');\n    }\n  };\n\n  const clickHandler = async e => {\n    e.preventDefault();\n\n    if (form.current.checkValidity()) {\n      const formContent = {\n        email: '',\n        password: '',\n        passwordConfirmation: '',\n        name: ''\n      };\n      [...form.current.elements].forEach(input => {\n        if (input.id === 'email') {\n          formContent.email = input.value;\n        } else if (input.id === 'password') {\n          formContent.password = input.value;\n        } else if (input.id === 'confirmPassword') {\n          formContent.passwordConfirmation = input.value;\n        } else if (input.id === 'userName') {\n          formContent.name = input.value;\n        }\n      });\n      const result = await handleSubmit(formContent);\n\n      if (result) {\n        setAlert(false);\n        history.push('/list', state);\n      }\n    } else {\n      setAlert('Please enter both email and password');\n      setTimeout(() => {\n        setAlert(null);\n      }, 5000);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"main\", {\n    key: alert,\n    className: signup.main,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 5\n    }\n  }, alert ? /*#__PURE__*/React.createElement(Alert, {\n    message: alert,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 18\n    }\n  }) : null, /*#__PURE__*/React.createElement(\"header\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 9\n    }\n  }, `Sign ${type === 'IN' ? 'in' : 'up'}`), /*#__PURE__*/React.createElement(\"small\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 9\n    }\n  }, type === 'IN' ? 'Welcome back! Sign in and meet with your friends' : 'Hello there! Sign up and start meeting new friends')), state.loading ? /*#__PURE__*/React.createElement(Loader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 13\n    }\n  }) : /*#__PURE__*/React.createElement(\"form\", {\n    ref: form,\n    className: signup.form,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"email\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    className: signup.input,\n    id: \"email\",\n    type: \"email\",\n    placeholder: \"your@mail.com\",\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"password\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    className: signup.input,\n    id: \"password\",\n    type: \"password\",\n    placeholder: \"password\",\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 17\n    }\n  })), type === 'IN' ? null : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"confirmPassword\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    className: signup.input,\n    id: \"confirmPassword\",\n    type: \"password\",\n    placeholder: \"confirm password\",\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"userName\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    className: signup.input,\n    id: \"userName\",\n    type: \"text\",\n    placeholder: \"username\",\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 21\n    }\n  }))), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: clickHandler,\n    type: \"submit\",\n    className: \"btn btn--orange\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 15\n    }\n  }, type === 'IN' ? 'Sign in' : 'Sign up'), type === 'IN' ? /*#__PURE__*/React.createElement(Link, {\n    to: \"/sign_up\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 22\n    }\n  }, \"Sign up\") : /*#__PURE__*/React.createElement(Link, {\n    to: \"/sign_in\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 22\n    }\n  }, \"Sign in\")), /*#__PURE__*/React.createElement(Link, {\n    to: \"/\",\n    className: signup.back,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 7\n    }\n  }, '< Back'));\n};\n\nfunction mapStateToProps({\n  state\n}) {\n  return {\n    state: { ...state\n    }\n  };\n}\n\nfunction mapActionsToProps(dispatch) {\n  return {\n    actions: bindActionCreators({ ...houseActions\n    }, dispatch)\n  };\n}\n\nSignUpPage.propTypes = {\n  actions: PropTypes.objectOf(PropTypes.any).isRequired,\n  type: PropTypes.string.isRequired,\n  history: PropTypes.objectOf(PropTypes.any).isRequired,\n  state: PropTypes.objectOf(PropTypes.any).isRequired\n};\nexport default connect(mapStateToProps, mapActionsToProps)(withRouter(SignUpPage));","map":{"version":3,"sources":["C:/Users/Usuario/reactProjects/findYourHouse/app/src/components/SignUpPage.js"],"names":["React","useEffect","useState","useRef","PropTypes","connect","bindActionCreators","withRouter","Link","houseActions","signup","Alert","Loader","SignUpPage","history","type","actions","state","alert","setAlert","form","authenticated","localStorage","getItem","push","setItem","currentUser","id","token","currentU","fetchSubscription","headers","Authorization","handleSubmit","formContent","method","body","JSON","stringify","email","password","credentials","password_confirmation","passwordConfirmation","name","picture","clickHandler","e","preventDefault","current","checkValidity","elements","forEach","input","value","result","setTimeout","main","loading","back","mapStateToProps","mapActionsToProps","dispatch","propTypes","objectOf","any","isRequired","string"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { withRouter, Link } from 'react-router-dom';\nimport * as houseActions from '../actions/houseActions';\nimport signup from '../styles/SignUpPage.module.css';\nimport Alert from './Alert';\nimport Loader from './Loader';\n\nconst SignUpPage = ({\n  history, type, actions, state,\n}) => {\n  const [alert, setAlert] = useState(false);\n\n  const form = useRef(null);\n\n  useEffect(() => {\n    if (state.authenticated\n      && (!localStorage.getItem('token') || localStorage.getItem('token') === 'undefined')) {\n      history.push('/list', state);\n      localStorage.setItem('token', state.authenticated);\n      localStorage.setItem('id', state.currentUser.id);\n    } else if (localStorage.getItem('token') && !state.authenticated) {\n      const token = localStorage.getItem('token');\n      const currentU = localStorage.getItem('id');\n\n      actions.fetchSubscription(`https://aqueous-wildwood-18424.herokuapp.com/users/${currentU}`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      }, null, true);\n    } else if (state.authenticated) {\n      history.push('/list', state);\n    }\n  }, [state.authenticated]);\n\n  const handleSubmit = async formContent => {\n    if (type === 'IN') {\n      actions.fetchSubscription('https://aqueous-wildwood-18424.herokuapp.com/auth/login', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: `${formContent.email}`,\n          password: `${formContent.password}`,\n        }),\n        headers: {\n          'Content-Length': 57,\n          'Content-Type': 'application/json; charset=utf-8',\n        },\n        credentials: 'same-origin',\n      }, 'SIGNIN');\n    } else if (type === 'UP') {\n      actions.fetchSubscription('https://aqueous-wildwood-18424.herokuapp.com/auth/signup', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: `${formContent.email}`,\n          password: `${formContent.password}`,\n          password_confirmation: `${formContent.passwordConfirmation}`,\n          name: `${formContent.name}`,\n          picture: 'https://joeschmoe.io/api/v1/random',\n        }),\n        headers: {\n          'Content-Length': 57,\n          'Content-Type': 'application/json; charset=utf-8',\n        },\n        credentials: 'same-origin',\n      }, 'SIGNIN');\n    }\n  };\n\n  const clickHandler = async e => {\n    e.preventDefault();\n\n    if (form.current.checkValidity()) {\n      const formContent = {\n        email: '',\n        password: '',\n        passwordConfirmation: '',\n        name: '',\n      };\n\n      [...form.current.elements].forEach(input => {\n        if (input.id === 'email') {\n          formContent.email = input.value;\n        } else if (input.id === 'password') {\n          formContent.password = input.value;\n        } else if (input.id === 'confirmPassword') {\n          formContent.passwordConfirmation = input.value;\n        } else if (input.id === 'userName') {\n          formContent.name = input.value;\n        }\n      });\n\n      const result = await handleSubmit(formContent);\n\n      if (result) {\n        setAlert(false);\n        history.push('/list', state);\n      }\n    } else {\n      setAlert('Please enter both email and password');\n      setTimeout(() => {\n        setAlert(null);\n      }, 5000);\n    }\n  };\n\n  return (\n    <main key={alert} className={signup.main}>\n      {\n        alert ? (<Alert message={alert} />) : null\n      }\n      <header>\n        <h1>{`Sign ${type === 'IN' ? 'in' : 'up'}`}</h1>\n        <small>\n          {type === 'IN' ? 'Welcome back! Sign in and meet with your friends' : 'Hello there! Sign up and start meeting new friends'}\n        </small>\n      </header>\n      {\n        state.loading\n          ? <Loader />\n          : (\n            <form ref={form} className={signup.form}>\n              <label htmlFor=\"email\">\n                <input className={signup.input} id=\"email\" type=\"email\" placeholder=\"your@mail.com\" required />\n              </label>\n              <label htmlFor=\"password\">\n                <input className={signup.input} id=\"password\" type=\"password\" placeholder=\"password\" required />\n              </label>\n              {type === 'IN' ? null : (\n                <>\n                  <label htmlFor=\"confirmPassword\">\n                    <input className={signup.input} id=\"confirmPassword\" type=\"password\" placeholder=\"confirm password\" required />\n                  </label>\n                  <label htmlFor=\"userName\">\n                    <input className={signup.input} id=\"userName\" type=\"text\" placeholder=\"username\" required />\n                  </label>\n                </>\n              )}\n              <button onClick={clickHandler} type=\"submit\" className=\"btn btn--orange\">\n                {type === 'IN' ? 'Sign in' : 'Sign up'}\n              </button>\n              {\n                type === 'IN'\n                  ? (<Link to=\"/sign_up\">Sign up</Link>)\n                  : (<Link to=\"/sign_in\">Sign in</Link>)\n              }\n            </form>\n          )\n      }\n      <Link to=\"/\" className={signup.back}>{'< Back'}</Link>\n    </main>\n  );\n};\n\nfunction mapStateToProps({ state }) {\n  return { state: { ...state } };\n}\n\nfunction mapActionsToProps(dispatch) {\n  return {\n    actions: bindActionCreators({ ...houseActions }, dispatch),\n  };\n}\n\nSignUpPage.propTypes = {\n  actions: PropTypes.objectOf(PropTypes.any).isRequired,\n  type: PropTypes.string.isRequired,\n  history: PropTypes.objectOf(PropTypes.any).isRequired,\n  state: PropTypes.objectOf(PropTypes.any).isRequired,\n};\n\nexport default connect(mapStateToProps, mapActionsToProps)(withRouter(SignUpPage));\n"]},"metadata":{},"sourceType":"module"}